<?php get_header(); ?>
<!-- カテゴリ情報取得 -->
<?php
    $category = get_the_category();
    $cat_id   = $category[0]->cat_ID;
    $cat_name = $category[0]->cat_name;
?>
    <% include template/_nav-category %>
    <section class="container">
            <h1 class="heading-category"><?php echo $cat_name; ?></h1>
    </section>

    <section class="c-visualPanel u-mb50">
        <div class="c-visualPanel-body">
            <div class="c-visualPanel-contant">
                <a href="<?php the_permalink();?>">
                    <div class="c-visualPanel-thumbnail c-visualPanel-thumbnail--one">
                        <?php
                        $postslist = get_posts('numberposts=1&category='.$cat_id.'&orderby=post_date&order=DESC"');
                        foreach ($postslist as $post) : setup_postdata($post);
                        ?>
                        <?php
                            if ( has_post_thumbnail() ) {
                                the_post_thumbnail();
                            }
                        ?>
                        <h1 class="c-visualPanel-heading">
                            <?php the_title(); ?>
                        </h1>
                        <?php
                         endforeach;
                        wp_reset_postdata();
                        ?>
                    </div>
                </a>
            </div>
            <div class="c-visualPanel-contant">
                <?php
                $postslist_second = get_posts('offset=1&numberposts=4&category='.$cat_id.'&orderby=post_date&order=DESC"');
                foreach ($postslist_second as $post) : setup_postdata($post);
                ?>
                <div class="c-visualPanel-box">
                    <a href="<?php the_permalink();?>">
                        <div class="c-visualPanel-thumbnail">
                            <?php
                            if ( has_post_thumbnail() ) {
                                the_post_thumbnail('medium');
                            }
                            ?>
                            <h1 class="c-visualPanel-heading">
                                <?php the_title(); ?>
                            </h1>
                        </div>
                    </a>
                </div>
                <?php
                endforeach;
                wp_reset_postdata();
                ?>
            </div>
        </div>
    </section>
    <div class="container">
        <?php $postslist_masonry = get_posts('offset=5&numberposts=8&category='.$cat_id.'&orderby=post_date&order=DESC&paged='.$paged); ?>
        <div class="row fn-grid">
            <?php foreach ($postslist_masonry as $post) : setup_postdata($post); ?>
            <div class="col s6 m3 fn-grid-item">
                <section class="card card--masony">
                    <a href="<?php the_permalink();?>">
                        <div class="card-image">
                            <?php
                            if ( has_post_thumbnail() ) {
                                the_post_thumbnail('medium');
                            }
                            ?>
                        </div>
                        <h1 class="card-action card-action--masonry">
                            <?php the_title(); ?>
                        </h1>
                    </a>
                </section>
            </div>
            <?php endforeach; ?>
        </div>
        <div class="pager">
            <?php global $wp_rewrite;
            $paginate_base = get_pagenum_link(1);
            if(strpos($paginate_base, '?') || ! $wp_rewrite->using_permalinks()){
                $paginate_format = '';
                $paginate_base = add_query_arg('paged','%#%');
            }
            else{
                $paginate_format = (substr($paginate_base,-1,1) == '/' ? '' : '/') .
                user_trailingslashit('page/%#%/','paged');;
                $paginate_base .= '%_%';
            }
            echo paginate_links(array(
                'base' => $paginate_base,
                'format' => $paginate_format,
                'total' => $wp_query->max_num_pages,
                'mid_size' => 4,
                'current' => ($paged ? $paged : 1),
                'prev_text' => '«',
                'next_text' => '»',
                )); ?>
            </div>
            <?php wp_reset_postdata(); ?>
    <?php get_footer(); ?>
    <script src="<?php bloginfo( 'template_directory' ); ?>/js/index.min.js"></script>
    <script src="<?php bloginfo( 'template_directory' ); ?>/js/category.min.js"></script>
    </body>
</html>
